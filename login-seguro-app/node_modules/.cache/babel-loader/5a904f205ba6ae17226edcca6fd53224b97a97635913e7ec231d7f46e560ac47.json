{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import{Box,Container,VStack,Heading,Text,Button,Alert,AlertIcon,useToast}from'@chakra-ui/react';import{supabase}from'../lib/supabaseClient';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const navigate=useNavigate();const toast=useToast();useEffect(()=>{checkUser();// Escuchar cambios en la sesión\nconst{data:authListener}=supabase.auth.onAuthStateChange((event,session)=>{if(event==='SIGNED_OUT'){navigate('/');}else if(!session){navigate('/');}else{setUser(session.user);}});return()=>{// Limpiar el listener cuando el componente se desmonte\nif(authListener&&authListener.subscription){authListener.subscription.unsubscribe();}};},[navigate]);const checkUser=async()=>{try{const{data:{user:currentUser},error}=await supabase.auth.getUser();if(error){throw error;}if(!currentUser){navigate('/');return;}setUser(currentUser);}catch(error){toast({title:'Error',description:error.message,status:'error',duration:3000});navigate('/');}finally{setLoading(false);}};const handleSignOut=async()=>{try{const{error}=await supabase.auth.signOut();if(error)throw error;navigate('/');}catch(error){toast({title:'Error al cerrar sesión',description:error.message,status:'error',duration:3000});}};if(loading){return/*#__PURE__*/_jsx(Container,{maxW:\"container.sm\",py:10,children:/*#__PURE__*/_jsx(Text,{children:\"Cargando...\"})});}return/*#__PURE__*/_jsx(Container,{maxW:\"container.sm\",py:10,children:/*#__PURE__*/_jsxs(VStack,{spacing:8,children:[/*#__PURE__*/_jsx(Heading,{children:\"Perfil de Usuario\"}),/*#__PURE__*/_jsx(Box,{w:\"100%\",bg:\"white\",p:8,borderRadius:\"lg\",boxShadow:\"lg\",children:/*#__PURE__*/_jsxs(VStack,{spacing:4,align:\"stretch\",children:[/*#__PURE__*/_jsxs(Alert,{status:\"success\",borderRadius:\"md\",children:[/*#__PURE__*/_jsx(AlertIcon,{}),\"Sesi\\xF3n activa y segura\"]}),/*#__PURE__*/_jsxs(Text,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",user===null||user===void 0?void 0:user.email]}),/*#__PURE__*/_jsxs(Text,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"ID:\"}),\" \",user===null||user===void 0?void 0:user.id]}),/*#__PURE__*/_jsxs(Text,{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\xDAltimo inicio de sesi\\xF3n:\"}),' ',new Date(user===null||user===void 0?void 0:user.last_sign_in_at).toLocaleString()]}),/*#__PURE__*/_jsx(Button,{colorScheme:\"red\",onClick:handleSignOut,children:\"Cerrar Sesi\\xF3n\"})]})})]})});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","Box","Container","VStack","Heading","Text","Button","Alert","AlertIcon","useToast","supabase","jsx","_jsx","jsxs","_jsxs","Profile","user","setUser","loading","setLoading","navigate","toast","checkUser","data","authListener","auth","onAuthStateChange","event","session","subscription","unsubscribe","currentUser","error","getUser","title","description","message","status","duration","handleSignOut","signOut","maxW","py","children","spacing","w","bg","p","borderRadius","boxShadow","align","email","id","Date","last_sign_in_at","toLocaleString","colorScheme","onClick"],"sources":["/Users/Lenovo/Documents/GitHub/loginseguro/login-seguro-app/src/components/Profile.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  Box,\n  Container,\n  VStack,\n  Heading,\n  Text,\n  Button,\n  Alert,\n  AlertIcon,\n  useToast,\n} from '@chakra-ui/react';\nimport { supabase } from '../lib/supabaseClient';\n\nexport default function Profile() {\n  const [user, setUser] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const toast = useToast();\n\n  useEffect(() => {\n    checkUser();\n    // Escuchar cambios en la sesión\n    const { data: authListener } = supabase.auth.onAuthStateChange((event, session) => {\n      if (event === 'SIGNED_OUT') {\n        navigate('/');\n      } else if (!session) {\n        navigate('/');\n      } else {\n        setUser(session.user);\n      }\n    });\n\n    return () => {\n      // Limpiar el listener cuando el componente se desmonte\n      if (authListener && authListener.subscription) {\n        authListener.subscription.unsubscribe();\n      }\n    };\n  }, [navigate]);\n\n  const checkUser = async () => {\n    try {\n      const { data: { user: currentUser }, error } = await supabase.auth.getUser();\n      if (error) {\n        throw error;\n      }\n      if (!currentUser) {\n        navigate('/');\n        return;\n      }\n      setUser(currentUser);\n    } catch (error: any) {\n      toast({\n        title: 'Error',\n        description: error.message,\n        status: 'error',\n        duration: 3000,\n      });\n      navigate('/');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSignOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      navigate('/');\n    } catch (error: any) {\n      toast({\n        title: 'Error al cerrar sesión',\n        description: error.message,\n        status: 'error',\n        duration: 3000,\n      });\n    }\n  };\n\n  if (loading) {\n    return (\n      <Container maxW=\"container.sm\" py={10}>\n        <Text>Cargando...</Text>\n      </Container>\n    );\n  }\n\n  return (\n    <Container maxW=\"container.sm\" py={10}>\n      <VStack spacing={8}>\n        <Heading>Perfil de Usuario</Heading>\n        <Box w=\"100%\" bg=\"white\" p={8} borderRadius=\"lg\" boxShadow=\"lg\">\n          <VStack spacing={4} align=\"stretch\">\n            <Alert status=\"success\" borderRadius=\"md\">\n              <AlertIcon />\n              Sesión activa y segura\n            </Alert>\n            \n            <Text>\n              <strong>Email:</strong> {user?.email}\n            </Text>\n            <Text>\n              <strong>ID:</strong> {user?.id}\n            </Text>\n            <Text>\n              <strong>Último inicio de sesión:</strong>{' '}\n              {new Date(user?.last_sign_in_at).toLocaleString()}\n            </Text>\n\n            <Button\n              colorScheme=\"red\"\n              onClick={handleSignOut}\n            >\n              Cerrar Sesión\n            </Button>\n          </VStack>\n        </Box>\n      </VStack>\n    </Container>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}